<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="author" content="Kevin C. Klement" />
    <meta name="robots" content="noindex,nofollow" />
    <meta property="og:title" content="README" />
    <title>README</title>
    <style>
html {
line-height: 1.5;
font-family: 'Libertinus Serif', serif;
font-size: 20px;
}
body {
margin: 0 auto;
max-width: 36em;
text-align: justify;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
h1, h2, h3, h4 {
text-align: left;
page-break-after: avoid;
}
@media print {
body {
background-color: transparent;
color: black;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h1, h2, h3, h4 {
text-align: left;
page-break-after: avoid;
}
span.citation a:link,
span.citation a:visited,
span.citation a {
color: inherit;
text-decoration: none;
}
a.footnote-back {
display: none !important;
}
}
p {
margin: 1em 0;
}
img {
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
h1 span.header-section-number::after {
content: ".";
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 1.5em 1em 1.5em;
padding-left: 1em;
}
#footnotes hr {
display: none;
}
#footnotes {
margin-top: 2.4em;
}
#footnotes::before {
content: "Notes";
font-size: 2em;
font-weight: bold;
margin-block-start: 0.67em;
margin-block-end: 0.67em;
}
#footnotes ul, #footnotes ol {
margin-top: 10px;
}
code {
font-family: 'DejaVu Sans Code', 'DejaVu Sans Mono', 'Droid Sans Mono', 'Fira Code', 'Fira Mono', 'JetBrains Mono', Inconsolata, Cousine, 'IBM Plex Mono', 'Red Hat Mono', 'Sarasa Mono K', 'Ubuntu Mono', Consolas, Menlo, Monaco, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
white-space: pre-wrap;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
sup {
white-space: nowrap;
line-height: 0;
font-size: 75%;
position: relative;
vertical-align: baseline;
top: -0.5em;
}
sub {
white-space: nowrap;
line-height: 0;
font-size: 75%;
position: relative;
vertical-align: baseline;
top: 0.3em;
line-height: 0;
}
span.smallcaps{
font-variant: small-caps;
}
span.underline {
text-decoration: underline;
}
div.column{
display: inline-block;
vertical-align: top;
width: 50%;
}

div.csl-entry {
margin-left: 1.5em;
text-indent: -1.5em;
}
ul.task-list{
list-style: none;
}
.pagebreak {
page-break-after: always;
}
.display.math{
display: block;
text-align: center;
margin: 0.5rem auto;
}
@page {
size: Letter;
margin: 1in;
counter-increment: page;
@bottom-center {
content: counter(page);
}
}
@page:first {
@bottom-center {
content: none;
}
} </style>
</head>
<body>
<h1 id="open-guide-typesetting-framework">Open Guide Typesetting
Framework</h1>
<h2 id="introduction">Introduction</h2>
<p>Web-based academic typesetting framework for open access guides, open
access journals, etc.</p>
<p>Although it can be configured to use other tools additionally, it is
primarily designed for typesetting academic works using <a href="https://pandoc.org/">pandoc</a>, and other open source tools like
LaTeX. The framework makes use of the flexibility of pandoc’s
academic-oriented flavor of markdown in its source documents. These can
in turn be used to create high-quality output production files in many
different file formats. Output formats can include typographically
sophisticated pdfs, as well as more accessible formats such as html/web
pages, and others such as ePub, for the distribution of academic
publications in many forms and modalities.</p>
<p>The framework includes the <a href="https://github.com/frabjous/open-guide-editor">Open Guide
Editor</a> as a submodule, to be used in the typesetting process. This
is a web-based text editor that provides live-updating previews of html-
or pdf-based output formats (or both) for the source file being edited.
(A video showing its capabilities can be found on its github page
through the link just given.)</p>
<p>The framework was created to be used by the <a href="https://jhaponline.org"><em>Journal for the History of Analytical
Philosophy</em></a>, as well as the forthcoming <em>Open Guide to
Bertrand Russell’s Philosophy</em>, which I am editing, but may be
useful to others undertaking similar projects. Thus, the framework is
being made available open source and free for others to use, modify, and
benefit from.</p>
<h2 id="features">Features</h2>
<p>The Open Guide Typesetting Framework provides the following
features:</p>
<ul>
<li><p>Remote log in and user maintenance for editors and typesetters
attached to a given project.</p></li>
<li><p>A means for editing and maintaining the metadata for a given
typesetting assignment, using customizable fields appropriate to the
document types of the works published by the project.</p></li>
<li><p>A mechanism for uploading submitted documents, automatically
converting them to the markdown format used by the framework, and doing
additional processing.</p></li>
<li><p>Automatically extraction of bibliographic data from uploaded
files, or from separate bibliography files. Text of extracted entries
can be used to search online bibliographic databases for automatic
download of structured bibliographic data. Bibliographies can created in
a format compatible with <a href="https://citationstyles.org/">Citation
Style Language</a>, and the citeproc citation processor used by
pandoc.</p></li>
<li><p>Automatic conversion of citations in imported documents to
pandoc-style style citations consistent with the bibliographies
created.</p></li>
<li><p>The ability to copy-edit and typeset markdown files, with the
ability to preview multiple output files created from the same source
file.</p></li>
<li><p>A mechanism for producing page proofs and sharing them with
authors, including the ability to add queries, comments, and corrections
on the proofs, whether in html or pdf format. These corrections and
comments can be submitted back to the editors for purposes of creating
finalized versions.</p></li>
<li><p>Final production of a typeset document in any number of output
formats, including optimizations and post-processing. Multiple editions
or versions of the same work can be produced over time, using a
version-numbering scheme.</p></li>
</ul>
<h2 id="additional-documentation">Additional Documentation</h2>
<p>This repository contains additional documentation broken down into
three additional files, on the following topics.</p>
<ul>
<li><p><a href="https://github.com/frabjous/open-guide-typesetting-framework/blob/main/doc/installation.md">Installation
instructions</a> (for system administrators)</p></li>
<li><p><a href="https://github.com/frabjous/open-guide-typesetting-framework/blob/main/doc/configuration.md">Project
configuration and settings</a> (for project leaders and/or their
technical support helpers)</p></li>
<li><p><a href="https://github.com/frabjous/open-guide-typesetting-framework/blob/main/doc/usage.md">Regular
usage information</a> (for editors/typesetters)</p></li>
</ul>
<p>Hopefully answers to most questions can be found in the documents
above. If not, feel free to contact me.</p>
<h2 id="todo-roadmap">TODO / Roadmap</h2>
<p>The framework is mostly feature-complete at this point, at least for
my own use cases. However, more beta testing and bug fixing may be
needed at this stage. Pull requests for expansions for other use cases
are welcome. There are also areas for improvement, especially with
regard to bibliographic management and automated interaction with
bibliographic databases. Improvements will hopefully be implemented at
some point. Feature requests and bug reports can be posted here on
GitHub.</p>
<h2 id="trivia">Trivia</h2>
<p>This is a sequel to an earlier project entitled <a href="https://bitbucket.org/frabjous/journal-tools">journal-tools</a>,
which was also used by the <a href="https://jhaponline.org"><em>Journal
for the History of Analytical Philosophy</em></a> for many years.</p>
<!--
This code provides a web-based framework for typesetting academic journal articles and book reviews using LaTeX. Editors can log in, create projects, convert other file formats to LaTeX, edit LaTeX files, and natbib-based bibliographies, create page proofs and leave comments on them, share proofs with authors, allow authors to leave comments and answer queries on these proofs, and create web-optimized PDFs for online publication.

The framework was designed for [*The Journal for the History of Analytical Philosophy*](https://jhaponline.org) but may be adapted for use by other journals, or others in general.

## Requirements and Installation

You will need:

* A PHP-enabled web-server; I recommend running it on a Linux/Unix based system (but haven't tested other operating systems)
* Other helper libraries created by me: [KCKlib](https://bitbucket.org/frabjous/kcklib); [KCK Icons](https://bitbucket.org/frabjous/icons) and [K(ev)E(dit)](https://bitbucket.org/frabjous/ke); these are expected be installed in immediate subfolders of the web server root directory `kcklib/`, `icons/` and `ke/`; as well as CodeMirror in a `ke/codemirror/` subfolder. These can be optionally installed through the `initial_setup.php` script.
* A number of other programs used either by K(ev)E(dit) or Journal Tools for performing conversions, typesetting, optimization, etc. These include [TeXlive](https://www.tug.org/texlive/) (or another TeX distribution, for processing LaTeX files), [rubber](https://launchpad.net/rubber/) (for processing LaTeX errors), [LibreOffice](https://www.libreoffice.org/) (for convering Word Processor files to markup files),  [pandoc](https://pandoc.org/) (for converting markup formats to LaTeX), [ghostscript](https://www.ghostscript.com/) (for output PDF files), [qpdf](https://qpdf.sourceforge.io/) (for optimizing pdfs), the mupdf project’s [mutool](https://mupdf.com/index.html) (for converting PDF pages to images that can be displayed in a browser), [flite](http://www.festvox.org/flite/) and [lame](http://lame.sourceforge.net/) (for K(ev)E(dit)'s text-to-speech features). The executables for these programs should be found in the `$PATH` for the webserver user.

For installation and setup:

* Clone this repository into your webserver document root; rename the output folder if you wish.
* From within the subfolder created, from the command line execute the `initial_setup.php` script with php.
* The two steps above, for example might be (from a terminal):

```bash
cd /home/web/public_html # or whatever the webserver root folder is
git clone https://bitbucket.org/frabjous/journal-tools.git
mv journal-tools myjournal
cd myjournal
php initial_setup.php
```
* The setup script will ask for the name of the journal, contact information, etc., and in the process will create the first user of the framework and provide a password.
* The script may also be used to install KCKlib, KCK Icons and K(ev)E(dit)/Codemirror if not installed already. This functionality requires that [git](https://git-scm.com/) and [npm](https://www.npmjs.com/) are installed on the server.
* Login to the framework (e.g. `https://myserver.com/myjournal/`) through your browser to ensure that the created user and password work as expected. That user can create others users (who will be sent invitations via email).

## Usage

Here is a rough summary of usage. Fuller instructions for how the system is used for JHAP can be found with the [JHAP Typesetting Guide](https://bitbucket.org/frabjous/jhap-cls/src/master/jhap_typesetting_guide.md):

1. After logging in, the user will see a list of projects. There is a field to create a new one.
2. Each project is given a unique document number; this is meant to match the number given in an [OJS](https://openjournalsystems.com/) or similar system (and future versions of this project may allow for automatic integration with OJS).
3. This will bring up a page to enter metadata, and choose between articles and review. Fill in a click save.
4. Back at the project listing, there is now a box for the new project, and a link to upload a file for conversion; all file formats which can be imported into LibreOffice and/or Pandoc are allowed, including Word, etc.
5. The next step is to edit the bibliography by clicking the "edit bibliography" link; when the bibliography is finalized, you can move to the next step.
6. Click the "create LaTeX file" link to convert the uploaded file to LaTeX format; you will be automatically redirected to a page where the LaTeX file can be edited. This uses K(ev)E(dit); see [its documentation](https://bitbucket.org/frabjous/ke/) for more information. Use the "play button" icon to create a PDF at least once.
7. When the LaTeX file is in good shape, return to the main page for the framework (by clicking back in your browser, or renavigating to its page). Create a set of proofs with "create new proof set".
8. This will bring up the editor's version of viewing the proofs; queries can be added by drawing boxes on the page, and the toolbar at the top can be used for navigating between pages.
9. Click back to return the menu, and there are two links for the proof set, an editor link and author link. The author link should be provided to the author, who can use it to add comments, corrections and respond to queries. This link provides further instructions when first visited.
10. When author corrections are submitted, the journal contact is emailed. Changes may be made to the LaTeX file with "edit LaTeX file", and additional proof sets created as needed.
11. When all corrections are made, the "create optimized PDF" link will create a smaller, and web-optimized PDF, which should be the published (e.g. as "galleys" in OJS).

## Customization

A different document class other than `jhap.cls` can be chosen at setup when running the `initial_setup.php` script, or changed by directly editing the file `jtsettings.json` created by that script.

A different bibliography style can be used by creating a javascript file called `custombibstyle.js` which defines a function:

```javascript
function bblEntryFor(bibkey, bibdata, elem) {
    // ...
}
```

This function takes three arguments: a citation key, used, e.g., in LaTeX `\cite` commands, bibliographical data, as an object, and the form element on the page where such data is entered. This function should output a string used as the LaTeX `thebibliography` listing item for the entry. For more details, it would be best to compare to the `bblEntryFor` function defined in the file `editbib.php`, which is the version of the function used by JHAP. The output should be natbib-compatible.

Note that this script is used *instead* of BibTeX, which is not used at all, though BibTeX files may be imported.

Finally, by default PHP’s `mail(...)` function is used for sending email. However, you
can substitute a custom defined function by creating a file named `customemail.php`
and place it in the folder chosen during setup for storing data and files for
the framework. This PHP file should define a function `jt_custom_email` that
takes three arguments, `$to` (which will be the email address of the recipient),
`$subject` (which will be the subject of the email), and `$message`, which is
expected to be an HTML string representing the body of the email. The return value
of the function should be `true` on success and `false` on failure. For example:

```php
<?php

function jt_custom_email($to, $subject, $message) {
    $success = ...
    return $success;
}
```
The file may of course load other packages, such as [PHPMailer](https://github.com/PHPMailer/PHPMailer), etc., in order to define the function. If this file is not created or this function is not defined, the framework will use PHP’s default `mail(...)` function.
-->
<h2 id="license">License</h2>
<p>Copyright 2023 © <a href="https://people.umass.edu/klement">Kevin C.
Klement</a>. This is free software, which can be redistributed and/or
modified under the terms of the <a href="https://www.gnu.org/licenses/gpl.html">GNU General Public License
(GPL), version 3</a>.</p>
<p>The favicon is based on <a href="https://commons.wikimedia.org/wiki/File:JS_Icon_Edit_White.svg">JS_Icon_Edit_White.svg</a>
by <a href="https://commons.wikimedia.org/wiki/User:Stalinsunnykvj">Jstalins</a>,
licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">Creative
Commons Attribution Share-Alike 4.0 International</a> license.</p>
</body>
</html>
